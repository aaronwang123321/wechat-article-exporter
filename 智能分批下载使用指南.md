# 🚀 智能分批下载使用指南

## 概述

智能分批下载管理器是一个全新的高级下载功能，它能够：

- 📦 **自动分批处理** - 将大量文章自动分成小批次下载
- 🧠 **智能调节** - 根据网络状况和成功率自动调整批次大小
- 🔄 **断点续传** - 网络中断后自动恢复下载
- 🎯 **失败重试** - 智能重试机制，提高下载成功率
- 📊 **实时监控** - 详细的进度显示和统计信息

## 启动智能下载

### 1. 选择文章
在文章导出页面中：
1. 选择要下载的公众号
2. 使用筛选功能找到目标文章
3. 勾选要下载的文章（支持全选）

### 2. 打开智能下载器
点击 **"智能分批下载"** 按钮，打开智能下载管理器界面。

## 配置参数

### 基本配置

#### 批次大小 (1-20篇)
- **默认值**: 5篇/批次
- **建议**:
  - 网络稳定：8-15篇
  - 网络不稳定：3-5篇
  - 文章较大或图片多：1-3篇

#### 下载间隔 (1-30秒)
- **默认值**: 2秒
- **建议**:
  - 正常情况：2-5秒
  - 频率限制严格：5-10秒
  - 大量下载：10-30秒

#### 最大重试次数 (1-10次)
- **默认值**: 3次
- **说明**: 单个批次失败后的最大重试次数

### 智能功能

#### 智能调节批次大小
- **开启**: 系统根据下载成功率自动调整批次大小
- **关闭**: 使用固定的批次大小

#### 成功率阈值 (50-100%)
- **默认值**: 80%
- **说明**: 当成功率低于此值时，系统会减小批次大小

## 下载过程监控

### 整体进度
- **进度条**: 显示总体下载进度
- **文章计数**: 已完成/总数量
- **当前批次**: 正在处理的批次编号
- **下载速度**: 实时计算的下载速度
- **预估时间**: 根据当前速度预估的剩余时间

### 批次详情
每个批次都有独立的状态显示：
- ⏳ **等待中**: 批次还未开始
- 🔄 **运行中**: 正在下载，显示实时进度
- ✅ **已完成**: 批次成功完成
- ❌ **失败**: 批次失败，显示错误信息
- ⏸️ **已暂停**: 用户主动暂停

### 统计信息
- **完成批次**: 成功完成的批次数量
- **失败批次**: 失败的批次数量
- **成功率**: 批次级别的成功率
- **总重试次数**: 所有批次的重试次数总和

## 操作控制

### 暂停和恢复
- **暂停**: 在任何时候都可以暂停下载
- **恢复**: 暂停后可以继续下载，不会丢失进度
- **自动暂停**: 连续失败3个批次后会自动暂停

### 取消下载
- 可以随时取消正在进行的下载任务
- 已下载的文章会保留

### 重试失败
- 下载完成后，可以单独重试失败的文章
- 系统会自动识别失败的文章并重新下载

## 智能调节机制

### 批次大小自动调节
系统会根据以下因素自动调整批次大小：

1. **成功率低于阈值** (默认80%)
   - 将批次大小减少到原来的70%
   - 最小不低于1篇

2. **成功率高于95%且速度快**
   - 将批次大小增加到原来的130%
   - 最大不超过设定的最大值

### 失败处理策略
1. **单个批次失败**: 自动重试，最多重试设定次数
2. **连续失败**: 连续3个批次失败会自动暂停，提醒用户检查网络
3. **网络问题**: 自动识别网络超时，调整下载策略

## 网络中断应对

### 断网处理
- **短暂断网**: 系统会自动重试
- **长时间断网**: 任务会暂停，等待网络恢复后可以继续

### 恢复下载
1. 网络恢复后，点击"恢复下载"
2. 系统会从中断的地方继续
3. 已下载的内容不会丢失

## 最佳实践

### 大量文章下载 (100+篇)
```
批次大小: 5-8篇
下载间隔: 5-10秒
重试次数: 3次
智能调节: 开启
```

### 网络不稳定环境
```
批次大小: 1-3篇
下载间隔: 10-15秒
重试次数: 5次
智能调节: 开启
成功率阈值: 70%
```

### 快速下载 (网络良好)
```
批次大小: 10-15篇
下载间隔: 2-3秒
重试次数: 2次
智能调节: 开启
成功率阈值: 85%
```

## 错误处理

### 常见错误及解决方案

#### "下载失败，请重试"
- **原因**: 网络问题或服务器限制
- **解决**: 增加下载间隔，减少批次大小

#### "代理服务器不可用"
- **原因**: 私有代理服务器失效
- **解决**: 检查代理服务器设置，或联系技术支持

#### "连续失败自动暂停"
- **原因**: 网络环境不佳或频率限制
- **解决**: 检查网络连接，增加下载间隔后恢复

### 性能优化建议

1. **合理设置批次大小**
   - 不要设置过大的批次，容易触发限制
   - 不要设置过小的批次，影响下载效率

2. **适当的下载间隔**
   - 过短容易被限制
   - 过长影响效率

3. **使用智能调节**
   - 建议开启智能调节功能
   - 让系统自动优化下载策略

## 技术说明

### 下载流程
1. **任务分配**: 将文章列表分成多个批次
2. **并发控制**: 每个批次内的文章并发下载
3. **重试机制**: 失败的批次自动重试
4. **进度同步**: 实时更新下载进度
5. **结果打包**: 所有下载完成后自动打包

### 缓存策略
- 下载的文章内容会临时存储在内存中
- 所有批次完成后统一打包下载
- 失败的批次不会影响已成功的内容

### 代理支持
- 自动使用配置的私有代理服务器
- 支持多个代理轮换使用
- 代理失效时自动切换

## 故障排除

### 下载速度过慢
1. 检查网络连接
2. 减少批次大小
3. 增加下载间隔
4. 检查代理服务器状态

### 频繁失败
1. 检查私有代理设置
2. 减少批次大小到1-2篇
3. 增加下载间隔到10秒以上
4. 检查微信登录状态

### 内存占用过高
1. 减少批次大小
2. 分多次下载
3. 清理浏览器缓存

## 更新日志

### v1.0.0 (初始版本)
- ✅ 基础分批下载功能
- ✅ 智能批次大小调节
- ✅ 断点续传支持
- ✅ 失败重试机制
- ✅ 实时进度监控
- ✅ 详细统计信息

---

💡 **提示**: 如果遇到问题，建议先尝试减少批次大小和增加下载间隔。大多数下载问题都与网络限制有关。